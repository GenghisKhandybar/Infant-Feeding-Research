---
title: "Jake Interaction Analysis"
author: "Jake Esprabens"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: false
---

```{r setup, include=FALSE}
include_rejectors <- c(0, 1)
source("shared_setup.R")
```

# 3. When the state is bottle-offer and infant cues occur (especially Blocks mouth and Lip compression, but others, too):


```{r}
interaction_data <- data_duration %>% 
  mutate(next_dyad_unit = lead(dyad_unit),
         switch = if_else(next_dyad_unit == dyad_unit, 0, 1)) %>% 
  group_by(id, dyad_set) %>% 
  mutate(chain_group = cumsum(switch) - switch) %>%  #Switch == 1 at end of group, chain group changes at start of new group
  ungroup() %>% 
  mutate(next_behavior = if_else(switch == 1, lead(Behavior), "NA")) %>% 
  group_by(id, dyad_set, chain_group) %>% 
  mutate(next_behavior = if_else(next_behavior == "NA", last(next_behavior), next_behavior)) %>%
  
  ungroup() %>%
  mutate(prev_behavior = if_else(lag(switch) == 1, lag(Behavior), NULL)) %>%

  mutate(next_behavior_group = case_when(
      next_behavior == "Pushes bottle into infant's mouth" ~ "Controlling",
      next_behavior == "Verbal stimulation of sucking or feeding" ~ "Controlling",
      next_behavior == "Physical stimulation of sucking or feeding" ~ "Controlling",
      next_behavior == "Assesses bottle contents" ~ "Controlling",
      next_behavior == "Verbal limiting of intake" ~ "Controlling",
      next_behavior == "Bottle offered" ~ "Controlling", # bottle offered as controlling??
      next_behavior == "Verbal acknowledgement of fullness" ~ "Responsive",
      next_behavior == "Verbal acknowledgement of hunger" ~ "Responsive",
      next_behavior == "Bottle not in mouth" ~ "Responsive",
      next_behavior == "Bottle in mouth" ~ "Responsive", # bottle in mouth as responsive??
      next_behavior == "Burping" ~ "Responsive",
      next_behavior == "Allows infant to hold bottle" ~ "Responsive",
      next_behavior == "Indicates feeding is over" ~ "Responsive",
      next_behavior == "Looks at phone or device" ~ "Uninvolved",
      next_behavior == "Propped bottle" ~ "Uninvolved"
  )) %>%
  filter(next_behavior != "NA")
  


all_dyad_table_data <- interaction_data %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  select(Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior)
```

## a,b) How often does this lead to a controlling maternal behavior? How often does this lead to responsive behaviors?

#### For All Dyad Sets

```{r}

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="stack",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Number of Behaviors for each \nInfant Cue After Bottle is offered")+
  theme(plot.title = element_text(size=12))

with(all_dyad_table_data, table(Behavior, next_behavior_group)) %>%
  addmargins(margin = 2,FUN = list("Total Count" = sum)) %>%
  kable(caption = "Number of Behaviors for each \nInfant Cue After Bottle is offered")
  


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is offered")+
  theme(plot.title = element_text(size=12))

with(all_dyad_table_data, prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "Proportion of Behaviors for each \nInfant Cue After Bottle is offered",
        digits = 3)


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is offered")+
  theme(plot.title = element_text(size=12))

specific_behavior <- interaction_data %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  filter(Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  select(Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior)
  
with(specific_behavior, prop.table(table(Behavior, next_behavior_group)),1) %>%
  kable(caption = "Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is offered",
        digits = 3)


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is offered")+
  theme(plot.title = element_text(size=12))

with(all_dyad_table_data, prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "Proportion of Behaviors for each \nInfant Cue After Bottle is offered",
        digits = 3)
```



#### By Dyad Set

```{r}
#making the data for the tables
dyad_set_table <- interaction_data %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  select(dyad_set, Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior, dyad_set)
```

```{r}
interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="stack",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Number of Behaviors for each \nInfant Cue After Bottle is Offered")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)

# still looking for a better solution for a table
with(dyad_set_table[dyad_set_table$dyad_set == "2wkB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "2 Week - Number of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "2moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "2 Month - Number of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "4moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "4 Month - Number of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "6moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "6 Month - Number of Behaviors for each \nInfant Cue After Bottle is Offered")


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)


with(dyad_set_table[dyad_set_table$dyad_set == "2wkB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "2moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "4moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "6moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is Offered")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)

with(dyad_set_table %>% filter(
        dyad_set == "2wkB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table %>% filter(
        dyad_set == "2moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table %>% filter(
        dyad_set == "4moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table %>% filter(
        dyad_set == "6moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle offered",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)

with(dyad_set_table[dyad_set_table$dyad_set == "2wkB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "2moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "4moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")

with(dyad_set_table[dyad_set_table$dyad_set == "6moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is Offered")
```

## c) How many subsequent bottle-offers occur until mother indicates feed is over?

```{r}
interaction_data %>%
  filter(prev_behavior == "Bottle offered" | Behavior == "Indicates feeding is over") %>%
  select(dyad_unit, dyad_set, id, prev_behavior, Behavior) %>%
  mutate(prev_behavior = replace_na(prev_behavior, "NA")) %>%
  group_by(dyad_set, id) %>%
  summarise(count_bottle_offers = sum(prev_behavior == "Bottle offered")) %>%
  ggplot(aes(x = count_bottle_offers, color = dyad_set)) +
  geom_freqpoly(stat = "count", binwidth = 1, linetype = "solid") + 
  xlab("Number of Bottle Offers") + 
  theme(panel.grid.major.y = element_blank()) +
  ggtitle("Number of Bottle Offers Until \nMom Indicates Feed is Over") + 
  labs(color='Dyad Set') 

```

```{r}
interaction_data %>%
  filter(prev_behavior == "Bottle offered" | Behavior == "Indicates feeding is over") %>%
  select(dyad_unit, dyad_set, id, prev_behavior, Behavior) %>%
  mutate(prev_behavior = replace_na(prev_behavior, "NA")) %>%
  group_by(dyad_set,id) %>%
  summarise(count_bottle_offers = sum(prev_behavior == "Bottle offered")) %>%
  group_by(dyad_set) %>%
  summarise_at(vars(count_bottle_offers),
               list(size = ~length(.),
                    ~mean(.),
                    ~sd(.),
                    ~min(.),
                    Q1 = ~quantile(., 0.25),
                    ~median(.), Q3 = ~quantile(., 0.75),
                    ~max(.))) %>%
  kable(digits = 4)

```


```{r}
# Becase this is continuous, I used a violin plot
bottle_offers <- interaction_data %>%
  group_by(dyad_set, id) %>%
  filter(Behavior == "Bottle offered") %>%
  slice(1) %>%
  mutate(bottle_offer_time = time) %>%
  select(dyad_set, id, Behavior, bottle_offer_time)


feed_over <- interaction_data %>%
  group_by(dyad_set, id) %>%
  filter(Behavior == "Indicates feeding is over") %>%
  slice(1) %>%
  mutate(feeding_over_time = time) %>%
  select(dyad_set, id, Behavior, feeding_over_time)


bottle_offers %>% 
  left_join(feed_over, by =c("dyad_set", "id")) %>%
  select(dyad_set, id, bottle_offer_time, feeding_over_time) %>%
  mutate(bot_offer_per_min = (feeding_over_time - bottle_offer_time) / 60) %>%
  ggplot(aes(x = dyad_set, y = bot_offer_per_min, color = dyad_set)) +
  geom_violin() +
  geom_jitter() +
  theme(panel.grid.major.y = element_blank()) +
  ggtitle("Number of Bottle Offers Per Mintue Until \nMom Indicates Feed is Over") + 
  labs(color='Dyad Set') +
  coord_flip() +
  ylab("Number of Bottle Offers Per Minute") +
  xlab("") +
  theme(legend.title = element_blank()) +
  scale_x_discrete(limits=rev)
  
  
# there is an instance where the bot_offer_per_min is < 0.  Because the first time the bottle was offered was after indicates feeding is over. is this possible?
  # for 2wk, 70346
```


```{r}
bottle_offers %>% 
  left_join(feed_over, by =c("dyad_set", "id")) %>%
  select(dyad_set, id, bottle_offer_time, feeding_over_time) %>%
  mutate(bot_offer_per_min = (feeding_over_time - bottle_offer_time) / 60) %>%
  group_by(dyad_set) %>%
  drop_na() %>%
  summarise_at(vars(bot_offer_per_min),
               list(size = ~length(.),
                    ~mean(.),
                    ~sd(.),
                    ~min(.),
                    Q1 = ~quantile(., 0.25),
                    ~median(.), Q3 = ~quantile(., 0.75),
                    ~max(.))) %>%
  kable(digits = 4)

```





# 4. When the state is bottle-not-in-mouth and infant cues occur:


## a,b) How often does this lead to a controlling maternal behavior? How often does this lead to responsive behaviors?

```{r}
all_dyad_table_data_4 <- interaction_data %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  select(Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior)

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="stack",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12))

with(all_dyad_table_data_4, table(Behavior, next_behavior_group)) %>%
  addmargins(margin = 2,FUN = list("Total Count" = sum)) %>%
  kable(caption = "Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")
  


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12))

with(all_dyad_table_data_4, prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth",
        digits = 3)


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12))

specific_behavior <- interaction_data %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  filter(Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  select(Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior)
  
with(specific_behavior, prop.table(table(Behavior, next_behavior_group)),1) %>%
  kable(caption = "Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is not in mouth",
        digits = 3)


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12)) + 
  scale_fill_manual(values=c("antiquewhite", "aquamarine", "azure3", "blue", 
                             "brown", "burlywood", "cadetblue", "darkseagreen", 
                             "chocolate1", "darkgoldenrod", "darkgreen", "darkmagenta",
                             "darkolivegreen1", "darkred"))

with(all_dyad_table_data_4, prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth",
        digits = 3)
```


```{r}
#making the data for the tables
dyad_set_table_4 <- interaction_data %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  select(dyad_set, Behavior, next_behavior, next_behavior_group) %>%
  group_by(Behavior, dyad_set)
```

```{r}
interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="stack",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)

# still looking for a better solution for a table
with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2wkB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "2 Week - Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "2 Month - Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "4moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "4 Month - Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "6moB",], table(Behavior, next_behavior_group)) %>%
  kable(caption = "6 Month - Number of Behaviors for each \nInfant Cue After Bottle is not in mouth")


interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)


with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2wkB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "4moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "6moB",], prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet") %>%
  ggplot(aes(fill = next_behavior_group, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for Lip Compression \nand Blocks mouth After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12)) +
  facet_grid(~ dyad_set)

with(dyad_set_table_4 %>% filter(
        dyad_set == "2wkB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table_4 %>% filter(
        dyad_set == "2moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table_4 %>% filter(
        dyad_set == "4moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

with(dyad_set_table_4 %>% filter(
        dyad_set == "6moB",
         Behavior == "Lip compression/does not open mouth" |
         Behavior == "Blocks mouth with hands or feet"), prop.table(table(Behavior, next_behavior_group),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for \nLip compression does not open mouth and Blocks mouth")

interaction_data %>%
  select(dyad_unit, prev_behavior, Behavior, next_behavior, next_behavior_group, switch, dyad_set) %>%
  filter(prev_behavior == "Bottle not in mouth",
         dyad_unit == "Baby") %>%
  ggplot(aes(fill = next_behavior, x=Behavior)) +
  geom_bar(position="fill",stat ="count") + 
  labs(fill="Next Behavior") +
  theme(axis.title.x=element_blank()) +
  coord_flip() +
  ggtitle("Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")+
  theme(plot.title = element_text(size=12)) +
  scale_fill_manual(values=c("antiquewhite", "aquamarine", "azure3", "blue", 
                             "brown", "burlywood", "cadetblue", "darkseagreen", 
                             "chocolate1", "darkgoldenrod", "darkgreen", "darkmagenta",
                             "darkolivegreen1", "darkred")) +
  facet_grid(~ dyad_set)

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2wkB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "2 Week - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "2moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "2 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "4moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "4 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")

with(dyad_set_table_4[dyad_set_table_4$dyad_set == "6moB",], prop.table(table(Behavior, next_behavior),1)) %>%
  kable(caption = "6 Month - Proportion of Behaviors for each \nInfant Cue After Bottle is not in mouth")
```

